This code still produces non-printable characters on decryption (need to fix)
